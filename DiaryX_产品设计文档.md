# DiaryX 产品设计文档

## 1. 产品概述

### 1.1 产品愿景
DiaryX 是一个私密、离线优先的日记应用，通过多种输入方式（语音、文字、图片/视频）帮助用户快速记录想法、经历和回忆。利用本地 LLM 能力，智能协助用户记录、扩展、总结、搜索和分类日记条目。

### 1.2 核心价值观
- **隐私优先**：完全离线功能
- **简单易用**：零学习曲线的直观交互
- **智能辅助**：AI 驱动的内容增强和智能搜索能力
- **包容性**：多种输入方式适应用户不同偏好
- **美学设计**：现代、高级设计，流畅动画和玻璃拟态效果

### 1.3 目标用户
- **主要用户**：全球所有年龄段重视隐私和个人反思的用户
- **次要用户**：寻求AI辅助日记和内容组织的用户
- **第三级用户**：从传统纸质日记转向数字解决方案的用户

## 2. 用户场景和使用案例

### 2.1 主要使用案例
1. **快速记忆捕捉**：用户想在通勤时立即记录一个想法
2. **详细反思**：用户坐下来进行全面的日常日记会话
3. **记忆检索**：用户搜索过去的经历或特定事件
4. **情绪跟踪**：用户想要了解随时间变化的情绪模式
5. **视觉故事讲述**：用户通过照片和视频捕捉时刻并添加上下文

### 2.2 用户旅程地图
#### 首次用户旅程
1. 下载安装 → 安全设置 → 引导流程 → 首次条目创建 → AI功能发现
2. **解决的痛点**：功能不清晰、设置复杂、功能过多
3. **愉悦时刻**：流畅的语音录制、精美UI、即时AI辅助

#### 日常用户旅程
1. 应用启动 → 快速认证 → 捕捉方式选择 → 内容创建 → AI增强 → 保存和组织
2. **解决的痛点**：访问缓慢、输入方式有限、组织不佳
3. **愉悦时刻**：闪电般快速的条目创建、智能分类、精美时间线视图

## 3. 功能需求

### 3.1 核心功能

#### 3.1.1 多模态输入系统
**语音录制**
- 一键语音录制，带视觉波形
- 通过Gemma 3n进行异步语音转文字
- 音频压缩和存储管理

**文字输入**
- 简单文本编辑器，用于快速记录
- 自动保存功能
- 支持连续多段记录
- 输入后增强选项（润色、扩展、总结）

**视觉内容**
- 即时照片拍摄的相机集成
- 图库/照片库访问
- 视频录制能力（最多5分钟）
- 图像压缩，保留原图
- 视频缩略图提取用于AI处理

#### 3.1.2 AI驱动功能
**内容增强**
- 自动文本总结
- 内容扩展和详细说明建议
- 情绪和情感分析
- 智能标签和分类

**智能搜索**
- 基于向量的跨所有内容类型的语义搜索
- 语音查询支持
- 基于图像的搜索（"查找类似照片的条目"）
- 上下文感知结果排名
- 通过LLM进行搜索结果总结

**处理队列管理**
- 后台处理指示器
- 基于优先级的队列（用户发起 > 自动处理）
- 处理状态可视化
- 错误处理和重试机制

### 3.2 内容组织

#### 3.2.1 日历和时间线视图
**日历界面**
- 带每日条目指示器的月视图
- 详细每日分解的周视图
- 不同内容类型的视觉指示器：
  - 照片条目：小缩略图覆盖
  - 视频条目：播放按钮图标
  - 语音条目：波形图标
  - 文字条目：文档图标
  - 混合条目：多个图标
- **情绪指示器**：每天的颜色编码情绪指示器
- **情绪趋势**：随时间变化的情绪模式视觉表示

**时间线功能**
- 按时间顺序滚动的界面
- 筛选选项：内容类型、日期范围、情绪、标签
- 排序选项：日期、相关性、AI分析重要性
- 性能优化的无限滚动
- 带可扩展详情的预览卡片

#### 3.2.2 智能组织
**自动分类**
- 基于内容分析的AI生成标签
- 情绪分类（快乐、反思、焦虑、兴奋等）
- 活动检测（旅行、工作、关系、爱好等）
- 时间模式（晨间思考、晚间反思等）

**手动组织**
- 自定义标签创建和管理
- 手动情绪覆盖

### 3.3 分析和洞察

#### 3.3.1 个人仪表板
**情绪智能面板**
- 情绪趋势可视化（折线图、颜色编码日历）
- 来自最近条目的情绪词云
- 感恩和积极性指标
- 带AI洞察的每周情绪总结

**反思洞察**
- 写作频率和一致性跟踪
- 个人成长主题识别
- 重复话题和兴趣分析
- 记忆回忆模式

**内容统计**
- 总条目数和字数
- 媒体内容概览
- 最活跃的日期/时间
- 搜索模式分析

#### 3.3.2 数据可视化
- 情绪热力图日历
- 每周/每月趋势线
- 交互式情绪轮
- 标签关系网络
- 内容类型分布图表

### 3.4 简单LLM分析

#### 3.4.1 内容分析
**情绪模式识别**
- 每个日记条目的自动情绪分析
- 时间段的情绪趋势识别
- 使用LLM能力的简单情感分析

**内容洞察**
- 最近日记条目的定期分析（用户发起）
- 基于写作模式的LLM生成洞察
- 简单观察和模式
- 内容总结和扩写

#### 3.4.2 简化的LLM支持
**按需分析**
- 用户可以请求分析最近条目
- LLM提供洞察和观察
- 简单、非侵入性的分析方法

**基本分析功能**
- 关于写作模式的温和观察
- 适当时的内容建议
- 文本扩写和总结能力

## 4. 用户界面设计

### 4.1 设计系统

#### 4.1.1 响应式布局指南
**弹性布局原则**
- **避免固定宽高**：使用 padding、margins 和弹性容器，而不是固定尺寸
- **自适应组件**：利用 Row、Column、Expanded、Flexible 和 Padding 等组件实现响应式布局
- **屏幕尺寸兼容性**：设计组件以优雅适应不同手机屏幕尺寸
- **内容驱动尺寸**：让内容决定组件大小，配合适当的约束
- **间距系统**：使用一致的 padding/margin 值（8dp、16dp、24dp、32dp）实现可扩展设计

#### 4.1.2 色彩调色板
**浅色主题**
- 主要色：#8487E4（高级浅紫色）
- 次要色：#A8AAF0（柔和紫色）
- 背景：#FAFBFF（米白色）
- 表面：#FFFFFF（纯白色）
- 强调色：#6366F1（鲜艳紫色）
- 主要文字：#1F2937（深灰色）
- 次要文字：#6B7280（中灰色）

**深色主题**
- 主要色：#5B67D6（完美紫蓝色 - 头像色调）
- 次要色：#7B85E6（和谐紫色）
- 背景：#0B0B0F（极深蓝黑色）
- 表面：#161622（深蓝灰表面）
- 强调色：#454FA7（深沉高级紫）
- 主要文字：#F8FAFC（纯净白）
- 次要文字：#CBD5E1（柔和灰）

#### 4.1.3 视觉效果
- **现代平面设计**：简洁、极简美学，带几何元素
- **玻璃拟态**：带背景模糊效果的磨砂玻璃卡片
- **高斯模糊**：用于深度和焦点的微妙模糊效果
- **渐变覆盖**：流畅的颜色过渡和渐变
- **几何线条**：使用基本几何形状的简单矢量插图
- **流畅动画**：整个应用中的300-500ms微动画
- **浮动元素**：带微妙阴影的升高卡片和按钮
- **渐进式披露**：清晰的信息层次和揭示模式

### 4.2 页面结构和导航

#### 4.2.1 应用导航架构
```
开屏流程：
├── 密码认证界面 - 数字密码输入
└── 捕获界面 - 快速条目创建（默认进入）

底部标签导航：
├── 时间线 - 带日历模式的按时间顺序条目视图
├── 报告 - 仪表板和分析
├── 捕捉（添加）- 快速条目创建
├── 搜索 - AI驱动的搜索和聊天机器人界面
└── 个人资料 - 设置和用户偏好
```

#### 4.2.2 详细页面规格

**密码认证屏幕**
- 简洁的数字密码输入界面
- 4-6位数字密码输入
- 密码错误提示和重试机制
- 应用图标和品牌展示

**捕捉/添加屏幕**
- 带三个大操作按钮的英雄区域：
  - 语音录制（带波形动画的麦克风图标）
  - 相机捕捉（带取景器动画的相机图标）
  - 文字输入（带打字动画的编辑图标）
- 连续录制支持 - 用户可以在一会话中添加多个条目
- 简单、专注的快速捕捉界面
- 最近条目预览（2-3张卡片）
- 快速情绪选择器

**时间线屏幕**
- 带头部日历模式切换的无限滚动卡片布局
- 日历模式：带情绪指示器的月/周视图
- 时间线模式：按时间顺序的条目视图
- 每张卡片包括：
  - 日期/时间戳
  - 内容预览（文字/图片/音频波形）
  - 情绪指示器（颜色编码圆圈）
  - 标签芯片
  - 扩展/编辑操作
- 浮动筛选按钮
- 顶部搜索集成
- 下拉刷新功能

**报告屏幕**
- 带分析和洞察的仪表板
- 关键指标显示：
  - 总条目数和字数
  - 情绪趋势和模式
  - 写作频率统计
  - 内容类型分布
- LLM分析按钮
- 数据可视化图表
- 每周/每月总结

**搜索屏幕**
- 在传统搜索和AI聊天机器人之间切换的双重界面
- 传统搜索：
  - 带语音输入选项的突出搜索栏
  - 多选筛选器（内容类型、日期范围）- 默认：无筛选
  - 最近搜索
  - 带视觉卡片的简单结果列表
- AI聊天机器人界面：
  - 对话式搜索的聊天界面
  - 预构建模板和提示词
  - LLM分析模板
  - 语音输入支持
  - 上下文感知回应

**LLM分析屏幕**
- 通过报告屏幕的专用按钮访问
- LLM洞察的简洁、简单界面
- "分析我的条目"按钮，用于按需分析
- 最近分析结果显示
- 简单洞察和观察
- 内容扩写和总结选项

**个人资料/设置屏幕**
- 带简单几何插图的温暖、欢迎文字
- 无用户头像 - 专注于个人连接
- 设置部分：
  - 安全（数字密码设置）
  - AI偏好（本地模型 vs 远程API/Ollama）
  - 外观（主题、文字大小）
  - 关于和帮助

### 4.3 动画指南
- **进入动画**：带淡入的向上滑动（300ms）
- **导航过渡**：共享元素过渡
- **加载状态**：带脉冲动画的骨架屏幕
- **语音录制**：实时波形可视化
- **AI处理**：带浮动点的微妙进度指示器
- **成功反馈**：带触觉反馈的微交互

## 5. 用户体验流程

### 5.1 引导流程
1. **欢迎屏幕**：带精美几何插图的品牌介绍
2. **输入方法教程**：语音/文字/相机功能的交互演示
3. **AI功能概览**：智能辅助能力的解释
4. **首次条目创建**：引导创建首篇日记条目（可跳过）
5. **成功庆祝**：带鼓励的欢迎消息

### 5.2 日常条目创建流程
1. **启动应用**：数字密码认证
2. **进入捕获界面**：直接进入快速记录界面
3. **选择输入方法**：语音、相机或文字选择
4. **内容创建**：
   - 语音：带视觉反馈的点击录制
   - 相机：带预览的即时捕捉
   - 文字：快速记录的简单文本编辑器
5. **连续记录**：支持一次会话中的多个片段
6. **输入后增强**（可选）：选择润色、扩展或总结内容
7. **审查和保存**：带元数据添加的最终审查
8. **成功反馈**：带下一步操作建议的温和确认

### 5.3 搜索和发现流程
1. **搜索启动**：基于文字、语音或图像的查询
2. **筛选应用**（可选）：应用内容类型和日期范围筛选器
3. **处理指示器**：搜索期间的视觉反馈
4. **结果显示**：带视觉卡片的简单结果列表
5. **结果选择**：预览和完整条目查看
6. **操作选项**：编辑或创建类似条目

### 5.4 异步处理流程

#### 5.4.1 语音转文字处理
1. **语音录制完成**：用户完成语音录制
2. **队列添加**：将语音文件添加到异步处理队列
3. **后台处理**：使用Gemma 3n进行语音转文字
4. **状态更新**：在时间线中显示处理状态
5. **结果保存**：转文字结果保存到数据库

#### 5.4.2 图片转文字处理
1. **图片上传完成**：用户完成图片拍摄或选择
2. **队列添加**：将图片文件添加到异步处理队列
3. **后台处理**：使用Gemma 3n进行图片内容识别
4. **状态更新**：在时间线中显示处理状态
5. **结果保存**：识别结果保存到数据库

#### 5.4.3 文本扩写处理
1. **用户请求**：用户选择扩写当前文本
2. **即时处理**：使用Gemma 3n进行文本扩写
3. **实时显示**：扩写结果实时显示给用户
4. **用户确认**：用户确认是否保存扩写结果

## 6. 边界情况和错误处理

### 6.1 常见边界情况
- **AI处理失败**：带用户反馈的重试机制
- **密码认证失败**：短时间内限制重试次数

### 6.2 错误状态
- **空状态**：鼓励首次创建流程
- **加载失败**：带有用消息的重试选项
- **搜索无结果**：替代搜索建议
- **AI处理错误**：回退到基本功能

## 7. 内容策略

### 7.1 引导内容
- **欢迎消息**：温暖、鼓励的语调
- **教程文字**：清晰、简洁的说明
- **占位符内容**：鼓舞人心的示例条目
- **技巧和窍门**：整个应用中的上下文帮助

### 7.2 空状态内容
- **无条目**：开始写日记的激励提示
- **无搜索结果**：有用的替代搜索建议
- **处理队列为空**：创建更多内容的鼓励
- **日历为空**：开始写日记习惯的温和提醒

### 7.3 AI生成内容
- **每日提示**：激发写作的深思熟虑问题
- **内容建议**：基于当前条目的扩展想法
- **总结文字**：用户想法的智能综合
- **搜索总结**：带提取洞察的上下文结果

### 7.4 简单LLM分析内容
- **情绪模式识别**：基于日记内容的简单情绪分析
- **写作模式观察**：对用户写作习惯的温和观察
- **内容总结**：对日记条目的智能总结
- **搜索洞察**：基于搜索结果的简单洞察

本产品设计文档为创建简单、用户友好的日记应用提供了基础，该应用平衡了AI能力与直观设计，专注于核心的日记记录和智能辅助功能。
